//-----------------------------------------------------------------------------
// Check ellipsis in instructions and operand definitions.
//-----------------------------------------------------------------------------
// RUN: not llvm-mdl %s 2>&1 | FileCheck %s

family test;

protected phases test { F1, E[1..20] };

cpu cpu { func_unit FU unit(); }
func_unit unit() {}
subunit unit() { latency unit(); }
latency unit() { def(E1, $dst); }

register r[0..16];
register_class GPR { r[0..16] };

operand IMM(GPR, ...) { type(int32); }           // Ellipsis not allowed

instruction abc(GPR op) { subunit(unit); }
instruction def(GPR op1, ..., GPR op2)           // Ellipsis must be last
     { subunit(unit); }

// CHECK: test_instr_1.mdl:18:18 Ellipsis not allowed in operand definitions
// CHECK: test_instr_1.mdl:21:26 Ellipsis must be last declared operand
// CHECK: Errors found, aborting
